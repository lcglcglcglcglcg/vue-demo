(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d18f5ed"],{"402c":function(t,i,e){"use strict";e.r(i);var s=function(){var t=this;t._self._c;return t._m(0)},n=[function(){var t=this,i=t._self._c;return i("div",{staticClass:"container"},[i("div",{staticStyle:{position:"relative"},attrs:{id:"captcha"}})])}],a=(e("14d9"),e("13d5"),{data(){return{}},mounted(){this.init()},methods:{init(){(function(t){const i=42,e=10,s=310,n=155,a=Math.PI,r=i+2*e;function l(t,i){return Math.round(Math.random()*(i-t)+t)}function c(t,i){const e=h("canvas");return e.width=t,e.height=i,e}function o(t){const i=h("img");return i.crossOrigin="Anonymous",i.onload=t,i.onerror=()=>{i.src=f()},i.src=f(),i}function h(t){return document.createElement(t)}function d(t,i){t.classList.add(i)}function u(t,i){t.classList.remove(i)}function f(){return"https://picsum.photos/300/150/?image="+l(0,100)}function p(t,s,n,r){t.beginPath(),t.moveTo(n,r),t.lineTo(n+i/2,r),t.arc(n+i/2,r-e+2,e,0,2*a),t.lineTo(n+i/2,r),t.lineTo(n+i,r),t.lineTo(n+i,r+i/2),t.arc(n+i+e-2,r+i/2,e,0,2*a),t.lineTo(n+i,r+i/2),t.lineTo(n+i,r+i),t.lineTo(n,r+i),t.lineTo(n,r),t.fillStyle="#fff",t[s](),t.beginPath(),t.arc(n,r+i/2,e,1.5*a,.5*a),t.globalCompositeOperation="xor",t.fill()}function m(t,i){return t+i}function C(t){return t*t}class v{constructor(t,i,e){this.el=t,this.success=i,this.fail=e}init(){this.initDOM(),this.initImg(),this.draw(),this.bindEvents()}initDOM(){const t=c(s,n),i=t.cloneNode(!0),e=h("div"),a=h("div"),r=h("div"),l=h("div"),o=h("span"),d=h("span");i.className="block",e.className="sliderContainer",a.className="refreshIcon",r.className="sliderMask",l.className="slider",o.className="sliderIcon",d.innerHTML="向右滑动滑块填充拼图",d.className="sliderText";const u=this.el;u.appendChild(t),u.appendChild(a),u.appendChild(i),l.appendChild(o),r.appendChild(l),e.appendChild(r),e.appendChild(d),u.appendChild(e),Object.assign(this,{canvas:t,block:i,sliderContainer:e,refreshIcon:a,slider:l,sliderMask:r,sliderIcon:o,text:d,canvasCtx:t.getContext("2d"),blockCtx:i.getContext("2d")})}initImg(){const t=o(()=>{this.canvasCtx.drawImage(t,0,0,s,n),this.blockCtx.drawImage(t,0,0,s,n);const i=this.y-2*e+2,a=this.blockCtx.getImageData(this.x,i,r,r);this.block.width=r,this.blockCtx.putImageData(a,0,i)});this.img=t}draw(){this.x=l(r+10,s-(r+10)),this.y=l(10+2*e,n-(r+10)),p(this.canvasCtx,"fill",this.x,this.y),p(this.blockCtx,"clip",this.x,this.y)}clean(){this.canvasCtx.clearRect(0,0,s,n),this.blockCtx.clearRect(0,0,s,n),this.block.width=s}bindEvents(){this.el.onselectstart=()=>!1,this.refreshIcon.onclick=()=>{this.reset()};let t,i,e=[],n=!1;this.slider.addEventListener("mousedown",(function(e){t=e.x,i=e.y,n=!0})),document.addEventListener("mousemove",a=>{if(!n)return!1;const r=a.x-t,l=a.y-i;if(r<0||r+38>=s)return!1;this.slider.style.left=r+"px";var c=(s-40-20)/(s-40)*r;this.block.style.left=c+"px",d(this.sliderContainer,"sliderContainer_active"),this.sliderMask.style.width=r+"px",e.push(l)}),document.addEventListener("mouseup",i=>{if(!n)return!1;if(n=!1,i.x==t)return!1;u(this.sliderContainer,"sliderContainer_active"),this.trail=e;const{spliced:s,TuringTest:a}=this.verify();s?a?(d(this.sliderContainer,"sliderContainer_success"),this.success&&this.success()):(d(this.sliderContainer,"sliderContainer_fail"),this.text.innerHTML="再试一次",this.reset()):(alert("验证失败"),d(this.sliderContainer,"sliderContainer_fail"),this.fail&&this.fail(),setTimeout(()=>{this.reset()},1e3))})}verify(){const t=this.trail,i=t.reduce(m)/t.length,e=t.map(t=>t-i),s=Math.sqrt(e.map(C).reduce(m)/t.length),n=parseInt(this.block.style.left);return{spliced:Math.abs(n-this.x)<10,TuringTest:i!==s}}reset(){this.sliderContainer.className="sliderContainer",this.slider.style.left=0,this.block.style.left=0,this.sliderMask.style.width=0,this.clean(),this.img.src=f(),this.draw()}}t.jigsaw={init:function(t,i,e){new v(t,i,e).init()}}})(window),jigsaw.init(document.getElementById("captcha"),(function(){alert("验证成功")}))}}}),r=a,l=(e("f035"),e("2877")),c=Object(l["a"])(r,s,n,!1,null,"3cf7f896",null);i["default"]=c.exports},a1e2:function(t,i,e){},f035:function(t,i,e){"use strict";e("a1e2")}}]);